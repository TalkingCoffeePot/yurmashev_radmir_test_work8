{% extends "base.html" %}
{% load static %}

{% block title %}Main Page{% endblock %}
{% block style %}{% static 'css/main_style.css' %}{% endblock %}
{% block content %}
        <h1>Отзовик "Отзовись!"</h1>

        <div class="task_container">
            <div class="card" style="width: 18rem;">
                <img src="{{product.image.url}}" class="card-img-top" alt="...">
                <div class="card-body">
                    <p class="card-text">{{product.category}}</p>
                    <h5 class="card-title">{{product.title}}</h5>
                    <p class="card-text">{{product.description}}</p>
                    <a href="{% url 'update_product' product.pk %}" class="btn btn-primary">Редактировать</a>
                    <a href="{% url 'delete_product' product.pk %}" class="btn btn-danger">Удалить</a>
                </div>
              </div>

              {% if user.is_authenticated %}
              <h3 id="write_comment">Написать комментарий</h3>
              <form method="post">
              {% csrf_token %}
                <!-- <textarea name="text"></textarea>
                <input type="number" name="rate"> -->
                {{form.text}}
                {{form.rate}}
                <button type="submit" class="btn btn-primary">Комментировать</button>
              </form>
          {% else %}
              <div class="panel panel-warning">
                  <div class="panel-heading">
                      <h3 class="panel-title">Комментарии</h3>
                  </div>
                  <div class="panel-body">
                      Только авторизованные пользователи могут оставлять комментарии.<br />
                  </div>
              </div>
              {% endif %}
            <h2>Комментарии</h2>
            {% for review in product.p_review.all %}
                <div class="task_box">
                    <span>{{review.author}}</span>
                    <p>{{review.text}}</p>
                    <h4>Оценка: {{review.rate}}</h4>
                </div>
                <hr>
                {% empty %}
                <p>Отзывов пока нет</p>
            {% endfor %}
        </div>
{% endblock %}